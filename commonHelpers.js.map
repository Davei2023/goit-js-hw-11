{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// src/js/pixabay-api.js\n\nexport const BASE_URL = 'https://pixabay.com/api/';\nexport const API_KEY  = '42030436-f44bf17f2fc4b636ae2b8b7a9';\n\n\nexport function buildUrl(query, { page = 1, perPage = 20, lang = 'en' } = {}) {\n  const p = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    page: String(page),\n    per_page: String(perPage),\n    lang,\n  });\n  return `${BASE_URL}?${p.toString()}`;\n}\n\n\nexport function getImagesByQuery(query, opts = {}) {\n  const url = buildUrl(query, opts);\n  return fetch(url).then(r => {\n    if (!r.ok) throw new Error(`HTTP ${r.status}`);\n    return r.json();\n  });\n}","// src/js/render-functions.js\nimport SimpleLightbox from 'simplelightbox';\n\nconst galleryEl = document.querySelector('.gallery');\nconst loaderEl  = document.querySelector('.loader-container');\n\nconst lightbox = new SimpleLightbox('.gallery-item a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function createMarkup(hits = []) {\n  return hits.map(({\n    webformatURL, largeImageURL, tags, likes, views, comments, downloads,\n  }) => `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${escapeHtml(tags || '')}\" loading=\"lazy\" />\n        <p class=\"gallery-descr\">\n          Likes: <span class=\"descr-span\">${likes}</span>\n          &nbsp; Views: <span class=\"descr-span\">${views}</span>\n          &nbsp; Comments: <span class=\"descr-span\">${comments}</span>\n          &nbsp; Downloads: <span class=\"descr-span\">${downloads}</span>\n        </p>\n      </a>\n    </li>\n  `).join('');\n}\n\nexport function createGallery(hits = [], { replace = true } = {}) {\n  const markup = createMarkup(hits);\n  if (replace) galleryEl.innerHTML = markup;\n  else galleryEl.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  galleryEl.innerHTML = '';\n}\n\nexport function showLoader() {\n  loaderEl.style.display = 'flex';\n  loaderEl.innerHTML = `<p style=\"margin:24px 0 0; color:#6b7280\">Loading images, please wait…</p>`;\n}\n\nexport function hideLoader() {\n  loaderEl.style.display = 'none';\n  loaderEl.innerHTML = '';\n}\n\nfunction escapeHtml(str) {\n  return String(str).replace(/[&<>\"']/g, s => ({\n    '&': '&amp;', '<': '&lt;', '>': '&gt;', '\"': '&quot;', \"'\": '&#39;',\n  }[s]));\n}","// стили\nimport './css/styles.css';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// js\nimport iziToast from 'izitoast';\nimport { getImagesByQuery } from './js/pixabay-api';\nimport { createGallery, clearGallery, showLoader, hideLoader } from './js/render-functions';\n\nconst refs = {\n  form: document.querySelector('.form'),\n  input: document.querySelector('.form input[name=\"search-text\"]'),\n  gallery: document.querySelector('.gallery'),\n  searchBtn: document.querySelector('.search-btn'),\n};\n\nrefs.form.addEventListener('submit', onSubmit);\n\nfunction onSubmit(e) {\n  e.preventDefault();\n\n  const query = refs.input.value.trim();\n\n  if (!query) {\n    createMessage(`The search field can't be empty! Please, enter your request!`);\n    return;\n  }\n  if (query.length > 100) {\n    createMessage(`Search query must be 100 characters or less.`);\n    return;\n  }\n\n  clearGallery();\n  showLoader();\n  refs.searchBtn.disabled = true;\n\n  getImagesByQuery(query, { page: 1, perPage: 20, lang: 'en' })\n    .then(({ hits }) => {\n      if (!Array.isArray(hits) || hits.length === 0) {\n        createMessage(`Sorry, there are no images matching your search query. Please, try again!`);\n        return;\n      }\n      createGallery(hits, { replace: true });\n      refs.form.reset();\n    })\n    .catch(() => {\n      createMessage(`Something went wrong. Please, try again later.`);\n    })\n    .finally(() => {\n      hideLoader();\n      refs.searchBtn.disabled = false;\n    });\n}\n\nfunction createMessage(message) {\n  iziToast.show({\n    class: 'error-svg',\n    position: 'topRight',\n    icon: 'error-svg',\n    message,\n    maxWidth: '432',\n    messageColor: '#fff',\n    messageSize: '16px',\n    backgroundColor: '#EF4040',\n    close: false,\n    closeOnClick: true,\n  });\n}"],"names":["BASE_URL","API_KEY","buildUrl","query","page","perPage","lang","p","getImagesByQuery","opts","url","r","galleryEl","loaderEl","lightbox","SimpleLightbox","createMarkup","hits","webformatURL","largeImageURL","tags","likes","views","comments","downloads","escapeHtml","createGallery","replace","markup","clearGallery","showLoader","hideLoader","str","s","refs","onSubmit","e","createMessage","message","iziToast"],"mappings":"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"}